---
title: "Static Elasticity Flexdashboard"
author: "Lila Sahar and Juan Malaver, eCapital Advisors, Business Data Science"
date: "10/25/2021"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    theme: simplex
---

```{r, include=FALSE}
#sourcing my code from 'Elasticity_Functions.r'
source("../r_code/Elasticity_Functions.r", local = knitr::knit_global())
```

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(readxl)
library(ggplot2)

#importing data
descriptions_path <- "../data/raw_data_cereal_descriptions.xlsx"
prices_path <- "../data/raw_data_cereal_prices.xlsx"

descriptions_tbl <- input_descriptions(descriptions_path)
prices_tbl <- input_prices(prices_path)
```

```{r, include = FALSE}
#obtaining our data tables
top_three_brands_tbl <- get_top_three(descriptions_tbl, prices_tbl)
sales_tbl <- get_sales(descriptions_tbl, prices_tbl, top_three_brands_tbl)
sales_sample_tbl <- get_sales_sample(sales_tbl)
```

Page 1
=======================================================================

Row 1 {.tabset}
-----------------------------------------------------------------------

### Box Plot of Sales by Brand

```{r, echo = FALSE, warning = FALSE}
#box plot of sales by brand
plot_boxplot_sales(sales_tbl, "Brand Names", "Sales of Cereal Boxes", "Distribution of Sales by Brand")
```

### Box Plot of Prices by Brand

```{r, echo = FALSE, warning = FALSE}
#box plot of prices by brand
plot_boxplot_price(sales_tbl, "Brand Names", "Price of Cereal Boxes", "Distribution of Prices by Brand")
```

Row 2 {.tabset}
-----------------------------------------------------------------------

### Histogram of Sales

```{r, echo = FALSE, warning = FALSE}
#histogram for sales
plot_histogram_sales(sales_tbl, "Sales of Cereal Boxes", "Distribution of Sales")
```

### Histogram of Price

```{r, echo = FALSE, warning = FALSE}
#histogram for price
plot_histogram_price(sales_tbl, "Price of Cereal Boxes", "Distribution of Prices")
```

Page 2
=======================================================================

Row 1 {.tabset}
-----------------------------------------------------------------------

### Scatter Plot for Sales vs. Price

```{r static_plot, echo = FALSE, warning = FALSE}
#scatter plot for quantity vs price
plot_scatter(sales_sample_tbl)
```

### Random Intercepts

```{r static_plot_2, echo = FALSE, warning = FALSE}
#scatter plot for quantity vs price
plot_scatter(sales_sample_tbl, model = "RI")
```

### Random Intercepts Random Slopes

```{r static_plot_3, echo = FALSE, warning = FALSE}
#scatter plot for quantity vs price
plot_scatter(sales_sample_tbl, model = "RIRS")
```

Page 3
=======================================================================

Row 1
-----------------------------------------------------------------------

### Residuals vs Fitted

```{r, echo = FALSE, warning = FALSE}
#plot of residuals vs fitted
plot_fitted_vs_residual(sales_sample_tbl, model = "MEM")
```

Row 2
-----------------------------------------------------------------------

### Bootstrap Coefficient

```{r, echo = FALSE, warning = FALSE}
bootstrap_tbl <- readRDS(file = "bootstrap_tbl.rds")
ci <- get_ci_for_bootstrap(bootstrap_tbl)

##plot of bootstrap coefficient
plot_bootstrap(bootstrap_tbl)
```

